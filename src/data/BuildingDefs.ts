import { BuildingType, BuildingCategory, ROAD_CONSTRUCTION_WORK, BRIDGE_CONSTRUCTION_WORK } from '../constants';
import { BuildingDef } from '../types';

// constructionWork determines build time: ticks = constructionWork / (workers * 0.03)
// At 1800 ticks/day, with 3 workers: work 150 → 1667t ≈ 22h, work 250 → 2778t ≈ 1.5d
export const BUILDING_DEFS: Record<string, BuildingDef> = {
  [BuildingType.WOODEN_HOUSE]: {
    type: BuildingType.WOODEN_HOUSE,
    name: 'Wooden House',
    category: BuildingCategory.HOUSING,
    width: 3, height: 3,
    costLog: 24, costStone: 12, costIron: 0,
    maxWorkers: 0, workRadius: 0,
    constructionWork: 250,       // 5 workers → 22h, 2 workers → 2.3d
    residents: 5,
    description: 'A warm wooden house. Shelters up to 5 residents.',
    doorDef: { dx: 1, dy: 2, side: 'south' },
    upgradesTo: BuildingType.STONE_HOUSE,
    upgradeCostLog: 10, upgradeCostStone: 40, upgradeCostIron: 8,
    upgradeWork: 200,
  },
  [BuildingType.STORAGE_BARN]: {
    type: BuildingType.STORAGE_BARN,
    name: 'Storage Barn',
    category: BuildingCategory.STORAGE,
    width: 4, height: 4,
    costLog: 40, costStone: 16, costIron: 0,
    maxWorkers: 0, workRadius: 0,
    constructionWork: 300,       // 5 workers → 1.1d, 2 workers → 2.8d
    isStorage: true, storageCapacity: 6000,
    description: 'Stores food and goods. Reduces spoilage. Capacity: 6000.',
    doorDef: { dx: 2, dy: 3, side: 'south' },
    upgradesTo: BuildingType.STONE_BARN,
    upgradeCostLog: 0, upgradeCostStone: 60, upgradeCostIron: 16,
    upgradeWork: 250,
  },
  [BuildingType.STOCKPILE]: {
    type: BuildingType.STOCKPILE,
    name: 'Stockpile',
    category: BuildingCategory.STORAGE,
    width: 4, height: 4,
    costLog: 0, costStone: 0, costIron: 0,
    maxWorkers: 0, workRadius: 0,
    constructionWork: 15,        // 5 workers → 1.3h (quick to set up)
    isStorage: true, storageCapacity: 5000,
    blocksMovement: false,
    description: 'Open-air storage for raw materials. Capacity: 5000.',
  },
  [BuildingType.CROP_FIELD]: {
    type: BuildingType.CROP_FIELD,
    name: 'Crop Field',
    category: BuildingCategory.FOOD,
    width: 8, height: 8,
    costLog: 0, costStone: 0, costIron: 0,
    maxWorkers: 4, workRadius: 0,
    constructionWork: 60,        // 5 workers → 5.3h (plowing large area)
    blocksMovement: false,
    description: 'Grow crops. Plant in spring, harvest in autumn. 4 workers. Drag to resize.',
    flexible: true, minWidth: 3, minHeight: 3, maxWidth: 16, maxHeight: 16,
  },
  [BuildingType.GATHERING_HUT]: {
    type: BuildingType.GATHERING_HUT,
    name: 'Gathering Hut',
    category: BuildingCategory.FOOD,
    width: 3, height: 3,
    costLog: 30, costStone: 12, costIron: 0,
    maxWorkers: 4, workRadius: 30,
    constructionWork: 150,       // 5 workers → 13h, 2 workers → 1.4d
    requiresForest: true,
    description: 'Gathers berries, mushrooms, and roots from nearby forest. 4 workers.',
    doorDef: { dx: 1, dy: 2, side: 'south' },
    upgradesTo: BuildingType.GATHERING_LODGE,
    upgradeCostLog: 20, upgradeCostStone: 24, upgradeCostIron: 0,
    upgradeWork: 180,
  },
  [BuildingType.HUNTING_CABIN]: {
    type: BuildingType.HUNTING_CABIN,
    name: 'Hunting Cabin',
    category: BuildingCategory.FOOD,
    width: 3, height: 3,
    costLog: 38, costStone: 10, costIron: 0,
    maxWorkers: 3, workRadius: 30,
    constructionWork: 150,       // 5 workers → 13h, 2 workers → 1.4d
    description: 'Hunts deer for venison and leather. 3 workers.',
    doorDef: { dx: 1, dy: 2, side: 'south' },
    upgradesTo: BuildingType.HUNTING_LODGE,
    upgradeCostLog: 28, upgradeCostStone: 20, upgradeCostIron: 0,
    upgradeWork: 180,
  },
  [BuildingType.FISHING_DOCK]: {
    type: BuildingType.FISHING_DOCK,
    name: 'Fishing Dock',
    category: BuildingCategory.FOOD,
    width: 3, height: 4,
    costLog: 30, costStone: 16, costIron: 0,
    maxWorkers: 4, workRadius: 15,
    constructionWork: 180,       // 5 workers → 16h (waterside construction)
    requiresWater: true,
    description: 'Catches fish from nearby water. Must be placed adjacent to water. 4 workers.',
    doorDef: { dx: 1, dy: 3, side: 'south' },
  },
  [BuildingType.FORESTER_LODGE]: {
    type: BuildingType.FORESTER_LODGE,
    name: 'Forester Lodge',
    category: BuildingCategory.RESOURCE,
    width: 3, height: 3,
    costLog: 28, costStone: 12, costIron: 0,
    maxWorkers: 4, workRadius: 30,
    constructionWork: 150,       // 5 workers → 13h
    description: 'Plants and harvests trees for logs. 4 workers.',
    doorDef: { dx: 1, dy: 2, side: 'south' },
    upgradesTo: BuildingType.FORESTRY_HALL,
    upgradeCostLog: 40, upgradeCostStone: 28, upgradeCostIron: 0,
    upgradeWork: 220,
    upgradeSizeW: 4, upgradeSizeH: 4,
  },
  [BuildingType.WOOD_CUTTER]: {
    type: BuildingType.WOOD_CUTTER,
    name: 'Wood Cutter',
    category: BuildingCategory.RESOURCE,
    width: 2, height: 2,
    costLog: 24, costStone: 8, costIron: 0,
    maxWorkers: 1, workRadius: 0,
    constructionWork: 100,       // 5 workers → 9h, 1 worker → 1.9d
    description: 'Converts logs into firewood. 1 worker.',
    doorDef: { dx: 1, dy: 1, side: 'south' },
    upgradesTo: BuildingType.SAWMILL,
    upgradeCostLog: 30, upgradeCostStone: 20, upgradeCostIron: 12,
    upgradeWork: 200,
    upgradeSizeW: 3, upgradeSizeH: 3,
  },
  [BuildingType.BLACKSMITH]: {
    type: BuildingType.BLACKSMITH,
    name: 'Blacksmith',
    category: BuildingCategory.RESOURCE,
    width: 3, height: 3,
    costLog: 55, costStone: 32, costIron: 32,
    maxWorkers: 1, workRadius: 0,
    constructionWork: 350,       // 5 workers → 1.3d, 2 workers → 3.2d
    description: 'Forges tools from iron and logs. 1 worker.',
    doorDef: { dx: 1, dy: 2, side: 'south' },
    upgradesTo: BuildingType.IRON_WORKS,
    upgradeCostLog: 30, upgradeCostStone: 40, upgradeCostIron: 50,
    upgradeWork: 300,
  },
  [BuildingType.TAILOR]: {
    type: BuildingType.TAILOR,
    name: 'Tailor',
    category: BuildingCategory.RESOURCE,
    width: 3, height: 3,
    costLog: 32, costStone: 48, costIron: 18,
    maxWorkers: 1, workRadius: 0,
    constructionWork: 250,       // 5 workers → 22h, 2 workers → 2.3d
    description: 'Makes coats from leather. 1 worker.',
    doorDef: { dx: 1, dy: 2, side: 'south' },
  },
  [BuildingType.HERBALIST]: {
    type: BuildingType.HERBALIST,
    name: 'Herbalist',
    category: BuildingCategory.SERVICES,
    width: 3, height: 3,
    costLog: 26, costStone: 10, costIron: 0,
    maxWorkers: 1, workRadius: 30,
    constructionWork: 150,       // 5 workers → 13h
    description: 'Gathers herbs to improve citizen health. 1 worker.',
    doorDef: { dx: 1, dy: 2, side: 'south' },
  },
  [BuildingType.MARKET]: {
    type: BuildingType.MARKET,
    name: 'Market',
    category: BuildingCategory.SERVICES,
    width: 5, height: 5,
    costLog: 60, costStone: 40, costIron: 16,
    maxWorkers: 3, workRadius: 40,
    constructionWork: 500,       // 5 workers → 1.9d, 2 workers → 4.6d
    blocksMovement: false,
    description: 'Distributes goods to nearby houses. 3 vendors.',
  },
  [BuildingType.SCHOOL]: {
    type: BuildingType.SCHOOL,
    name: 'School',
    category: BuildingCategory.SERVICES,
    width: 4, height: 4,
    costLog: 82, costStone: 80, costIron: 40,
    maxWorkers: 1, workRadius: 0,
    constructionWork: 600,       // 5 workers → 2.2d, 2 workers → 5.6d
    description: 'Educates children. Educated workers produce +50%. 1 teacher.',
    doorDef: { dx: 2, dy: 3, side: 'south' },
    upgradesTo: BuildingType.ACADEMY,
    upgradeCostLog: 40, upgradeCostStone: 80, upgradeCostIron: 40,
    upgradeWork: 600,
  },
  [BuildingType.TRADING_POST]: {
    type: BuildingType.TRADING_POST,
    name: 'Trading Post',
    category: BuildingCategory.SERVICES,
    width: 5, height: 5,
    costLog: 58, costStone: 62, costIron: 40,
    maxWorkers: 2, workRadius: 0,
    constructionWork: 600,       // 5 workers → 2.2d, 2 workers → 5.6d
    requiresWater: true,
    description: 'Trade with merchants. Must be placed near water. 2 workers.',
    doorDef: { dx: 2, dy: 4, side: 'south' },
  },
  [BuildingType.ROAD]: {
    type: BuildingType.ROAD,
    name: 'Dirt Road',
    category: BuildingCategory.INFRASTRUCTURE,
    width: 1, height: 1,
    costLog: 1, costStone: 0, costIron: 0,
    maxWorkers: 0, workRadius: 0,
    constructionWork: ROAD_CONSTRUCTION_WORK,
    blocksMovement: false,
    description: 'Citizens walk 2x faster on roads. Cheap to build.',
  },
  [BuildingType.STONE_ROAD]: {
    type: BuildingType.STONE_ROAD,
    name: 'Stone Road',
    category: BuildingCategory.INFRASTRUCTURE,
    width: 1, height: 1,
    costLog: 0, costStone: 2, costIron: 0,
    maxWorkers: 0, workRadius: 0,
    constructionWork: 60,
    blocksMovement: false,
    upgradeFrom: BuildingType.ROAD,
    description: 'Citizens walk 3x faster on stone roads. Can be placed over dirt roads.',
  },
  [BuildingType.BRIDGE]: {
    type: BuildingType.BRIDGE,
    name: 'Wooden Bridge',
    category: BuildingCategory.INFRASTRUCTURE,
    width: 1, height: 1,
    costLog: 3, costStone: 2, costIron: 0,
    maxWorkers: 0, workRadius: 0,
    constructionWork: BRIDGE_CONSTRUCTION_WORK,
    blocksMovement: false,
    description: 'Allows citizens to cross water. Drag to span a river.',
  },
  [BuildingType.BAKERY]: {
    type: BuildingType.BAKERY,
    name: 'Bakery',
    category: BuildingCategory.FOOD,
    width: 3, height: 3,
    costLog: 36, costStone: 24, costIron: 8,
    maxWorkers: 2, workRadius: 0,
    constructionWork: 250,       // 5 workers → 22h
    description: 'Cooks raw ingredients into meals. Cooked food restores more and gives buffs. 2 workers.',
    doorDef: { dx: 1, dy: 2, side: 'south' },
  },
  [BuildingType.CHICKEN_COOP]: {
    type: BuildingType.CHICKEN_COOP,
    name: 'Chicken Coop',
    category: BuildingCategory.FOOD,
    width: 3, height: 3,
    costLog: 20, costStone: 8, costIron: 0,
    maxWorkers: 1, workRadius: 0,
    constructionWork: 150,       // 5 workers → 13h
    description: 'Raises chickens for eggs and feathers. Needs hay to feed them. 1 herder.',
  },
  [BuildingType.PASTURE]: {
    type: BuildingType.PASTURE,
    name: 'Pasture',
    category: BuildingCategory.FOOD,
    width: 6, height: 6,
    costLog: 16, costStone: 0, costIron: 0,
    maxWorkers: 1, workRadius: 0,
    constructionWork: 80,        // 5 workers → 7h (fencing)
    blocksMovement: false,
    description: 'Fenced area for cattle. Produces milk, wool, and leather. Needs hay. 1 herder. Drag to resize.',
    flexible: true, minWidth: 3, minHeight: 3, maxWidth: 12, maxHeight: 12,
  },
  [BuildingType.DAIRY]: {
    type: BuildingType.DAIRY,
    name: 'Dairy',
    category: BuildingCategory.RESOURCE,
    width: 3, height: 3,
    costLog: 30, costStone: 20, costIron: 4,
    maxWorkers: 1, workRadius: 0,
    constructionWork: 200,       // 5 workers → 18h
    description: 'Turns milk into cheese. 1 worker.',
    doorDef: { dx: 1, dy: 2, side: 'south' },
  },
  [BuildingType.TAVERN]: {
    type: BuildingType.TAVERN,
    name: 'Tavern',
    category: BuildingCategory.SERVICES,
    width: 4, height: 4,
    costLog: 50, costStone: 30, costIron: 10,
    maxWorkers: 1, workRadius: 0,
    constructionWork: 400,       // 5 workers → 1.5d
    description: 'Citizens visit in the evening for socializing and happiness. 1 barkeep.',
    doorDef: { dx: 2, dy: 3, side: 'south' },
  },
  [BuildingType.WELL]: {
    type: BuildingType.WELL,
    name: 'Well',
    category: BuildingCategory.SERVICES,
    width: 2, height: 2,
    costLog: 8, costStone: 20, costIron: 0,
    maxWorkers: 0, workRadius: 15,
    constructionWork: 100,       // 5 workers → 9h
    description: 'Decorative. Passively boosts happiness for citizens within 15 tiles.',
    upgradesTo: BuildingType.STONE_WELL,
    upgradeCostLog: 0, upgradeCostStone: 50, upgradeCostIron: 4,
    upgradeWork: 150,
  },
  [BuildingType.CHAPEL]: {
    type: BuildingType.CHAPEL,
    name: 'Chapel',
    category: BuildingCategory.SERVICES,
    width: 3, height: 3,
    costLog: 40, costStone: 50, costIron: 8,
    maxWorkers: 0, workRadius: 0,
    constructionWork: 350,       // 5 workers → 1.3d
    description: 'Weddings happen here. Boosts newlywed happiness and community morale.',
    doorDef: { dx: 1, dy: 2, side: 'south' },
  },
  [BuildingType.TOWN_HALL]: {
    type: BuildingType.TOWN_HALL,
    name: 'Town Hall',
    category: BuildingCategory.SERVICES,
    width: 5, height: 5,
    costLog: 80, costStone: 60, costIron: 20,
    maxWorkers: 0, workRadius: 0,
    constructionWork: 800,       // 5 workers → 3d (major community building)
    description: 'The heart of the village. Unlocks seasonal festivals that boost morale and grant bonuses.',
    doorDef: { dx: 2, dy: 4, side: 'south' },
  },
  [BuildingType.QUARRY]: {
    type: BuildingType.QUARRY,
    name: 'Stone Quarry',
    category: BuildingCategory.RESOURCE,
    width: 4, height: 3,
    costLog: 40, costStone: 0, costIron: 0,
    maxWorkers: 3, workRadius: 20,
    constructionWork: 300,       // 5 workers → 1.1d
    description: 'Miners quarry visible stone deposits nearby, then dig underground when the surface is exhausted. 3 workers.',
    doorDef: { dx: 1, dy: 2, side: 'south' },
  },
  [BuildingType.MINE]: {
    type: BuildingType.MINE,
    name: 'Iron Mine',
    category: BuildingCategory.RESOURCE,
    width: 4, height: 4,
    costLog: 60, costStone: 30, costIron: 0,
    maxWorkers: 3, workRadius: 20,
    constructionWork: 450,       // 5 workers → 1.7d
    description: 'Miners extract iron from visible deposits then dig underground veins. 3 workers.',
    doorDef: { dx: 1, dy: 3, side: 'south' },
  },

  // ── Tier-2 Upgraded Buildings (upgrade-only; costLog/Stone/Iron = 0 means cannot be built fresh) ──

  [BuildingType.STONE_HOUSE]: {
    type: BuildingType.STONE_HOUSE,
    name: 'Stone House',
    category: BuildingCategory.HOUSING,
    width: 3, height: 3,
    costLog: 0, costStone: 0, costIron: 0,
    maxWorkers: 0, workRadius: 0,
    constructionWork: 0,
    residents: 7,
    description: 'A sturdy stone house. Shelters up to 7 residents with better warmth retention.',
    doorDef: { dx: 1, dy: 2, side: 'south' },
    upgradeFrom: BuildingType.WOODEN_HOUSE,
  },
  [BuildingType.STONE_BARN]: {
    type: BuildingType.STONE_BARN,
    name: 'Stone Barn',
    category: BuildingCategory.STORAGE,
    width: 4, height: 4,
    costLog: 0, costStone: 0, costIron: 0,
    maxWorkers: 0, workRadius: 0,
    constructionWork: 0,
    isStorage: true, storageCapacity: 10000,
    description: 'Stone-walled barn. 10 000 capacity with superior spoilage protection.',
    doorDef: { dx: 2, dy: 3, side: 'south' },
    upgradeFrom: BuildingType.STORAGE_BARN,
  },
  [BuildingType.GATHERING_LODGE]: {
    type: BuildingType.GATHERING_LODGE,
    name: 'Gathering Lodge',
    category: BuildingCategory.FOOD,
    width: 3, height: 3,
    costLog: 0, costStone: 0, costIron: 0,
    maxWorkers: 6, workRadius: 40,
    constructionWork: 0,
    requiresForest: true,
    description: 'Upgraded gathering hut. 6 workers, wider 40-tile radius.',
    doorDef: { dx: 1, dy: 2, side: 'south' },
    upgradeFrom: BuildingType.GATHERING_HUT,
  },
  [BuildingType.HUNTING_LODGE]: {
    type: BuildingType.HUNTING_LODGE,
    name: 'Hunting Lodge',
    category: BuildingCategory.FOOD,
    width: 3, height: 3,
    costLog: 0, costStone: 0, costIron: 0,
    maxWorkers: 5, workRadius: 40,
    constructionWork: 0,
    description: 'Upgraded hunting cabin. 5 hunters, 40-tile radius.',
    doorDef: { dx: 1, dy: 2, side: 'south' },
    upgradeFrom: BuildingType.HUNTING_CABIN,
  },
  [BuildingType.FORESTRY_HALL]: {
    type: BuildingType.FORESTRY_HALL,
    name: 'Forestry Hall',
    category: BuildingCategory.RESOURCE,
    width: 4, height: 4,
    costLog: 0, costStone: 0, costIron: 0,
    maxWorkers: 6, workRadius: 40,
    constructionWork: 0,
    description: 'Upgraded forester lodge. 6 workers, 40-tile radius, larger 4×4 footprint.',
    doorDef: { dx: 1, dy: 3, side: 'south' },
    upgradeFrom: BuildingType.FORESTER_LODGE,
  },
  [BuildingType.SAWMILL]: {
    type: BuildingType.SAWMILL,
    name: 'Sawmill',
    category: BuildingCategory.RESOURCE,
    width: 3, height: 3,
    costLog: 0, costStone: 0, costIron: 0,
    maxWorkers: 2, workRadius: 0,
    constructionWork: 0,
    description: 'Upgraded wood cutter. 2 workers, yields 9 firewood per log. Larger 3×3 footprint.',
    doorDef: { dx: 1, dy: 2, side: 'south' },
    upgradeFrom: BuildingType.WOOD_CUTTER,
  },
  [BuildingType.IRON_WORKS]: {
    type: BuildingType.IRON_WORKS,
    name: 'Iron Works',
    category: BuildingCategory.RESOURCE,
    width: 3, height: 3,
    costLog: 0, costStone: 0, costIron: 0,
    maxWorkers: 2, workRadius: 0,
    constructionWork: 0,
    description: 'Upgraded blacksmith. 2 smiths with faster tool production.',
    doorDef: { dx: 1, dy: 2, side: 'south' },
    upgradeFrom: BuildingType.BLACKSMITH,
  },
  [BuildingType.STONE_WELL]: {
    type: BuildingType.STONE_WELL,
    name: 'Stone Well',
    category: BuildingCategory.SERVICES,
    width: 2, height: 2,
    costLog: 0, costStone: 0, costIron: 0,
    maxWorkers: 0, workRadius: 25,
    constructionWork: 0,
    description: 'Upgraded well. 25-tile radius, doubles happiness aura.',
    upgradeFrom: BuildingType.WELL,
  },
  [BuildingType.ACADEMY]: {
    type: BuildingType.ACADEMY,
    name: 'Academy',
    category: BuildingCategory.SERVICES,
    width: 4, height: 4,
    costLog: 0, costStone: 0, costIron: 0,
    maxWorkers: 2, workRadius: 0,
    constructionWork: 0,
    description: 'Upgraded school. 2 teachers, educated workers produce +75% instead of +50%.',
    doorDef: { dx: 2, dy: 3, side: 'south' },
    upgradeFrom: BuildingType.SCHOOL,
  },
};
